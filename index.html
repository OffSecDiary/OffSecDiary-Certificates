<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OffSecDiary | Universal Verification Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!-- HEADER -->
  <header class="osd-header">
    <div class="logo">
        <img src="logo.png" alt="OffSecDiary Logo">
    </div>
    <div class="brand">
      <h1>OffSecDiary</h1>
      <p>Hack | Defend | Innovate</p>
    </div>
  </header>

  <!-- EVENT SWITCHER -->
  <section class="event-menu">
    <h2>Select Verification Type</h2>

    <div class="event-grid">

      <button class="event-btn" data-target="ctf-part">
        üïµÔ∏è‚Äç‚ôÇÔ∏è CTF Participation
      </button>

      <button class="event-btn" data-target="ctf-win">
        üèÜ CTF Winners
      </button>

      <button class="event-btn" data-target="ctf-badge">
        üéñ CTF Winner Badges
      </button>

      <button class="event-btn" data-target="intern-cert">
        üíº Internship Certificates
      </button>

      <button class="event-btn" data-target="guest-cert">
        üé§ Guest Speaker Certificates
      </button>

      <button class="event-btn" data-target="sr-cert">
        ‚≠ê Special Recognition
      </button>

    </div>
  </section>

  <!-- VERIFICATION PANELS -->
  <section id="verification-panels">

    <!-- TEMPLATE OF PANEL -->
    <div class="verify-wrapper hidden" id="ctf-part">
      <h3>CTF Participation Verification</h3>
      <p class="subtitle">Enter certificate ID printed on top-left of the certificate.</p>

      <form class="verify-form" data-json="data/ctf_participation.json">
        <input type="text" placeholder="e.g. OFSD-CTF-25-0000" class="cert-input" required>
        <button type="submit">Verify</button>
      </form>

      <div class="results"></div>
    </div>

    <!-- WINNERS -->
    <div class="verify-wrapper hidden" id="ctf-win">
      <h3>CTF Winners Verification</h3>

      <form class="verify-form" data-json="data/ctf_winners.json">
        <input type="text" placeholder="e.g. OFSD-CTF-WIN-25-0000" class="cert-input" required>
        <button type="submit">Verify</button>
      </form>

      <div class="results"></div>
    </div>

    <!-- BADGES -->
    <div class="verify-wrapper hidden" id="ctf-badge">
      <h3>CTF Winner Badge Verification</h3>

      <form class="verify-form" data-json="data/ctf_winner_badges.json">
        <input type="text" placeholder="e.g. OFSD-CTF-BDG-25-0000" class="cert-input" required>
        <button type="submit">Verify</button>
      </form>

      <div class="results"></div>
    </div>

    <!-- INTERNSHIP -->
    <div class="verify-wrapper hidden" id="intern-cert">
      <h3>Internship Certificate Verification</h3>

      <form class="verify-form" data-json="data/internship_certificates.json">
        <input type="text" placeholder="e.g. OSD-INT-25-0000" class="cert-input" required>
        <button type="submit">Verify</button>
      </form>

      <div class="results"></div>
    </div>

    <!-- GUEST -->
    <div class="verify-wrapper hidden" id="guest-cert">
      <h3>Guest Speaker Certificate Verification</h3>

      <form class="verify-form" data-json="data/internship_guest_speakers.json">
        <input type="text" placeholder="e.g. OSD-GSP-25-0000" class="cert-input" required>
        <button type="submit">Verify</button>
      </form>

      <div class="results"></div>
    </div>

    <!-- SPECIAL RECOGNITION -->
    <div class="verify-wrapper hidden" id="sr-cert">
      <h3>Special Recognition Certificate Verification</h3>

      <form class="verify-form" data-json="data/internship_special_recognition.json">
        <input type="text" placeholder="e.g. OSD-REC-25-0000" class="cert-input" required>
        <button type="submit">Verify</button>
      </form>

      <div class="results"></div>
    </div>

  </section>

  <!-- SCRIPT -->
  <script>
    // Switch panels
    document.querySelectorAll(".event-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".verify-wrapper").forEach(v => v.classList.add("hidden"));
        document.getElementById(btn.dataset.target).classList.remove("hidden");
        window.scrollTo({ top: 350, behavior: "smooth" });
      });
    });

    // Verification logic
    document.querySelectorAll(".verify-form").forEach(form => {
      form.addEventListener("submit", async e => {
        e.preventDefault();

        let input = form.querySelector(".cert-input").value.trim().toUpperCase();
        let resultsBox = form.nextElementSibling;

        resultsBox.innerHTML = "<div class='loading'>Checking...</div>";

        const jsonURL = form.dataset.json;

        try {
          let data = await fetch(jsonURL).then(r => r.json());
          let info = data[input];

          if (!info) {
            resultsBox.innerHTML =
              `<div class='invalid'>
                 ‚ùå Certificate Not Found<br>
                 ID: <strong>${input}</strong>
               </div>`;
          } else {
            let formatted = Object.entries(info)
              .map(([k, v]) => `<p><strong>${k.toUpperCase()}:</strong> ${v}</p>`)
              .join("");

            resultsBox.innerHTML =
              `<div class='valid'>
                 ‚úÖ Certificate Verified<br>
                 ID: <strong>${input}</strong>
                 <div class='details'>${formatted}</div>
               </div>`;
          }

        } catch (err) {
          resultsBox.innerHTML = "<div class='invalid'>Error loading registry.</div>";
        }
      });
    });
  </script>

</body>
</html>